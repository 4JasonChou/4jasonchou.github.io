<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>實驗二 - 流程模擬</title>

  <!-- Lock Copy -->
  <style type="text/css">
    body {
    　-moz-user-select : none;
    　-webkit-user-select: none;
    }
  </style>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/grayscale.css" rel="stylesheet">

</head>

<body id="page-top">

  <div id="loadingImg" class="MyLoafingfixed"><div class="text-center myforntformat" style="width: 100%;">Loading...</div></div>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand js-scroll-trigger myforntformat" href="#page-top">中原大學論文研究</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <p class="nav-link js-scroll-trigger myforntformat" href="">剩於金幣袋數量 :</p>
          </li>
          <li class="nav-item">
            <p class="nav-link js-scroll-trigger myforntformat" id="titleBarForMoneyBagCounter" href="">17 </p>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- 捐款 Section -->
  <section id="projects" class="projects-section bg-light" >
    <div class="container" id="sectionForDonate" >

      <!-- Donate Intro Row -->
      <div class="row align-items-center no-gutters mb-4 mb-lg-5">
        <div class="col-xl-12 col-lg-12">
          <div class="text-center text-lg-left myforntformat">
            <h4>感謝您閱讀完所有故事</h4>
            <p class="mb-0" id="moneyDes">感謝您，我們將提供給您17 個代幣作為感謝(每一袋金幣表示會替您捐出100元)，讓您可以作為捐款的籌碼。<br />
              請根據剛才所閱讀之故事去分配您願意捐贈的數量。<br />
              您不一定要將所有的代幣用完，但每個捐款箱至少要有一個代幣。</p>
            <p class="mb-0"> - 每一袋金幣表示會替您捐出100元 </p>
            <p class="mb-0"> - 以下是您剩於的金幣袋數量 </p>
            <table><tr><td><img src="money.png" alt=""></td><td class="myforntformat" style="font-size:  50px;" id="desForMoneyBagCounter">X 17</td></tr></table>
          </div>
        </div>
      </div>

      <!-- Donate Box One Row -->
      <div class="row justify-content-center no-gutters mb-5 mb-lg-0" id="donateBoxGoh">
        <div class="col-lg-6">
          <img class="img-fluid" src="donateBox01.png" alt="">
        </div>
        <div class="col-lg-6">
          <div class="text-center h-100 project">
            <div class="d-flex h-100">
              <div class="project-text w-100 my-auto text-center text-lg-left myforntformat">
                <h4>財團法人勵馨社會福利事業基金會</h4>
                <p style="font-size: 20px;">( 幫助家暴受害者之基金會 )</p>
                <p style="font-size: 20px;" id="boxOne">已放入金幣袋數量 : 0 </p>
                <br />
                <table style="width:100%;font-size: 20px;" >
                  <tr>
                    <td><input type="button" Onclick="donateMinOneForBox01()" class="btn btn-primary " id="donateNo" value=" - 1 " /></td>
                    <td><input type="button" Onclick="donateAddOneForBox01()" class="btn btn-primary " id="donateYes" value=" + 1 " /></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Donate Box Two Row -->
      <div class="row justify-content-center no-gutters mb-5 mb-lg-0" id="donateBoxDep" >
        <div class="col-lg-6">
          <img class="img-fluid" src="donateBox02.png" alt="">
        </div>
        <div class="col-lg-6">
          <div class="text-center h-100 project">
            <div class="d-flex h-100">
              <div class="project-text w-100 my-auto text-center text-lg-left myforntformat">
                <h4>社團法人台灣憂鬱症防治協會</h4>
                <p style="font-size: 20px;">( 幫助憂鬱症之基金會 )</p>
                <p style="font-size: 20px;" id="boxTwo">已放入金幣袋數量 : 0 </p>
                <br />
                <table style="width:100%;font-size: 20px;" >
                  <tr>
                    <td><input type="button" Onclick="donateMinOneForBox02()" class="btn btn-primary " id="donateNo" value=" - 1 " /></td>
                    <td><input type="button" Onclick="donateAddOneForBox02()" class="btn btn-primary " id="donateYes" value=" + 1 " /></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Donate Box Three Row -->
      <div class="row justify-content-center no-gutters mb-5 mb-lg-0" id="donateBoxAft" >
        <div class="col-lg-6">
          <img class="img-fluid" src="donateBox03.png" alt="">
        </div>
        <div class="col-lg-6">
          <div class="text-center h-100 project">
            <div class="d-flex h-100">
              <div class="project-text w-100 my-auto text-center text-lg-left myforntformat">
                <h4>財團法人台灣更生保護會</h4>
                <p style="font-size: 20px;">( 幫助更生人之基金會 )</p>
                <p style="font-size: 20px;" id="boxThree">已放入金幣袋數量 : 0 </p>
                <br />
                <table style="width:100%;font-size: 20px;" >
                  <tr>
                    <td><input type="button" Onclick="donateMinOneForBox03()" class="btn btn-primary " id="donateNo" value=" - 1 " /></td>
                    <td><input type="button" Onclick="donateAddOneForBox03()" class="btn btn-primary " id="donateYes" value=" + 1 " /></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <p></p>
      <input type="button" Onclick="finishDonate()" class="btn btn-primary col-xl-12"  id="finalSubmitFinishDonate" value="完成捐款" />

    </div>

    <div class="container" id="sectionForRecordName" style="display:none">

      <!-- Des Intro Row -->
      <div class="row align-items-center no-gutters mb-4 mb-lg-5" >
        <div class="col-xl-12 col-lg-12">
          <div class="text-center text-lg-left myforntformat">
            <h4>感謝您的捐款！</h4>
            <p class="mb-0">請問您是否願意空開姓名至該基金會芳名錄 ? </p></br>
            <table class="myforntformat" style="width:100%;font-size:16px;">
              <!--Question Ele-->
              <fieldset>
                <tr height=50>
                  <td><input type="radio" name="donateShowName" value="Yes" >  願意公開姓名至基金會芳名錄</td>
                </tr>
                <tr height=50>
                  <td><input type="radio" name="donateShowName" value="No" > 不願意公開姓名至基金會芳名錄</td>
                </tr>
              </fieldset>
            </table>
          </br><p class="mb-0">(本研究“僅提供姓名”至該基金會，並不會提供額外任何隱私訊息(包含您的個人基本資料、填答內容)，以維護您的個人資料與隱私。)  </p></br>
            <input type="button" Onclick="finishAndSubmit()" class="btn btn-primary col-xl-12"  id="finishAndSubmit" value="next" />
          </div>
        </div>
      </div>

    </div>

    <!-- Uploading Page -->
    <div class="container" id="sectionForLonding" style="display:none">
      <!-- Des Intro Row -->
      <div class="row align-items-center no-gutters mb-4 mb-lg-5" >
        <div class="col-xl-12 col-lg-12">
          <div class="text-center myforntformat">
            <h4>Uploading... 請稍候...</h4>
          </div>
        </div>
      </div>
    </div>

    <div class="container">

      <!-- Des Intro Row -->
      <div class="row align-items-center no-gutters mb-4 mb-lg-5"  id="tanksExplan" style="display:none"> 
        <div class="col-xl-12 col-lg-12">
          <div class="text-center myforntformat">
            <h4>非常感謝您完成本實驗！</br>
              接下來將進行釋疑說明</h4>
            </br>
            <input type="button" Onclick="NextToPurpose()" class="btn btn-primary col-xl-6" value="next" />
          </div>
        </div>
      </div>

       <!-- Des Intro Row -->
       <div class="row align-items-center no-gutters mb-4 mb-lg-5" id="purposeExplan" style="display:none">
        <div class="col-xl-12 col-lg-12">
          <div class="text-lg-left myforntformat">
            <h4>實驗目的：</h4>
            <p class="mb-0" id="finalDes01">本實驗研究目的是想了解同理心誘發對於利社會行為的影響，並且瞭解心理病態人格特質者的利社會行為表現形態。而在剛才的實驗中，藉由讓您觀看故事、書寫故事內容的過程，讓您更能夠站在不同觀點(同理 或 站在客觀角度)去理解故事主角的狀態，而這樣的狀態是否會影響您的態度、情緒，進而影響到您是否願意幫助與主角相似的族群，以及願意幫助的量(如：本研究的捐款多寡)。而本研究的第一階段是了解您的心理病態人格特質及同理能力，目的在於了解在心理病態人格特質、同理能力的高、低程度不同，是否會影響利社會行為表現的型態。由上述的結果藉此能夠使我們了解同理心的運作模式及心理病態人格特質會有的利社會行為模式。</p>
          </div>
          <div class="text-center">
            </br>
            <input type="button" Onclick="NextToDeceive()" class="btn btn-primary col-xl-6" value="next" />
          </div>
        </div>
      </div>

       <!-- Des Intro Row -->
       <div class="row align-items-center no-gutters mb-4 mb-lg-5" id="deceiveExplan" style="display:none">
        <div class="col-xl-12 col-lg-12">
          <div class="text-lg-left myforntformat">
            <h4>欺瞞：</h4>
            <p class="mb-0" id="finalDes02">本研究中，有部分欺瞞參與者成分，內容如下： </br>
              1 . 本研究並未與科技部及基金會合作，且目的並非「調查大學生對不同族群之興趣及了解」，而此欺瞞目的是為了避免參與者猜測實驗目的及增加實驗的真實性，降低參與者出現社會期許效果。 </br>
              2 . 本研究並不會實際執行捐款或提供捐款者姓名至基金會，而此操弄目的是為了瞭解參與者在不同狀態下的利社會行為的類別及表現。</br>
              </p>
          </div>
          <div class="text-center">
            </br>
            <input type="button" Onclick="NextToQuestion()" class="btn btn-primary col-xl-6" value="next" />
          </div>
        </div>
      </div>

      <!-- Des Intro Row -->
      <div class="row align-items-center no-gutters mb-4 mb-lg-5" id="qustionExplan" style="display:none">
        <div class="col-xl-12 col-lg-12">
          <div class="text-lg-left myforntformat">
            <h4>解釋疑問：</h4>
            <p class="mb-0" id="finalDes03">若參與者欲更深入了解研究中的主題，可參考以下說明：</br>
              1 . 心理病態人格特質：心理病態人格特質並不等同於罹患心理疾患，而是有部分人格特質與心理病態人格者的表現相似(如：行事較為大膽、具有魅力、有自信、冷酷、為達目的不擇手段、同理心能力較低等…)。而此人格特質常見於特定產業中的專業人士。若您對於此議題感興趣，建議您可以閱讀書籍：《沒有良知的人：那些讓人不安的精神病態者》、《反社會人格者的告白：善於操弄人心、剝削弱點的天才》</br>
              2 . 同理：同理為大多數人熟知，根據過去學者定義同理為您目前所處在一個情緒狀態，而此情緒狀態與同理的對象(如：故事主角)有相似的情緒結構，是我們藉由觀察、想像此對象所誘發出來的，且我們能夠了解目前出現的情緒狀態是由對方造成的(De Vignemont & Singer, 2006)。而同理包含了認知同理及情感同理的成分。</br>
              </p>
          </div>
          <div class="text-center">
            </br>
            <input type="button" Onclick="NextToSup()" class="btn btn-primary col-xl-6" value="next" />
          </div>
        </div>
      </div>

      <!-- Des Intro Row -->
      <div class="row align-items-center no-gutters mb-4 mb-lg-5" id="supExplan" style="display:none">
        <div class="col-xl-12 col-lg-12">
          <div class="text-lg-left myforntformat">
            <h4>其他補充說明：</h4>
            <p class="mb-0">本研究所執行測驗並非臨床上標準化工具，因此結果並無優劣好壞之分，僅供參與者參考。若您在完成本實驗後仍有疑問及任何建議，歡迎與研究者聯繫：</br>
              研究生-廖婉婷 </br>
              聯絡電話：03-2653427，電子郵件信箱：liao9909@hotmail.com.tw </br>
              </p>
          </div>
          <div class="text-center">
            </br>
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- Footer -->
  <footer class="small text-center text-black-50">
    <div class="container">
      Chou4J &copy; 2020 - for 中原大學心理所碩士研究生：廖婉婷
    </div>
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Plugin JavaScript -->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Custom scripts for this template -->
  <script src="js/grayscale.min.js"></script>
  <script type="text/javascript" src="getUrlParam.js"></script>
  <script type="text/javascript" src="commonFuncs.js"></script>

</body>

<!-- JavaScript Part -->
<script type="text/javascript">
  /* Global var */
  var totalMoneyBag = 17;
  var totalMoneyBagUsed = 0;
  var BoxOneContentSize = 0;
  var BoxTwoContentSize = 0;
  var BoxThreeContentSize = 0;

  function init() {
    
    // Get Html Value to load story
    storyOne = UrlParam.paramValues("StoryOne")[0];
    storyTwo = UrlParam.paramValues("StoryTwo")[0];
    storyThree = UrlParam.paramValues("StoryThree")[0];
    userSituation = UrlParam.paramValues("UserSituation")[0];

    var donateForBoxGoh = getCookie("donateBoxGoh");
    var donateForBoxDep = getCookie("donateBoxDep");
    var donateForBoxAft = getCookie("donateBoxAft");


    if ( donateForBoxGoh == 1 )
    {
      totalMoneyBag = totalMoneyBag - 1 ;
      totalMoneyBagUsed = totalMoneyBagUsed + 1;
      BoxOneContentSize = BoxOneContentSize + 1;
    }
    else
    {
      document.getElementById("donateBoxGoh").style.display = "none";
    }

    if ( donateForBoxDep == 1 )
    {
      totalMoneyBag = totalMoneyBag - 1 ;
      totalMoneyBagUsed = totalMoneyBagUsed + 1;
      BoxTwoContentSize = BoxTwoContentSize + 1 ;
    }
    else
    {
      document.getElementById("donateBoxDep").style.display = "none";
    }

    if ( donateForBoxAft == 1 )
    {
      totalMoneyBag = totalMoneyBag - 1 ;
      totalMoneyBagUsed = totalMoneyBagUsed + 1;
      BoxThreeContentSize = BoxThreeContentSize + 1;
    }
    else
    {
      document.getElementById("donateBoxAft").style.display = "none";
    }

    UpdateMoneyBag();
    document.getElementById("boxOne").innerHTML = "已放入金幣袋數量 : " + BoxOneContentSize.toString();
    document.getElementById("boxTwo").innerHTML = "已放入金幣袋數量 : " + BoxTwoContentSize.toString();
    document.getElementById("boxThree").innerHTML = "已放入金幣袋數量 : " + BoxThreeContentSize.toString();

    getStoryInfo("A1");
    thisPageUsingTimerStart();

  }

  var loadingDivOpa = 1 ;
  function loadingDivOpaFade() {
    
    loadingDivOpa = loadingDivOpa - 0.1 ;
    if( loadingDivOpa <= 0 ) {
      document.getElementById("loadingImg").style.display = "none";
      clearInterval(loadingDivOpaFade);
      return;
    }
    document.getElementById("loadingImg").style.opacity=loadingDivOpa;
  }
  
  init();
  
  /* Process Func */
  function finishDonate(){
    document.getElementById("sectionForDonate").style.display = "none";    
    document.getElementById("sectionForRecordName").style.display = "block";    
  }

  function finishAndSubmit(){

    var needRecordName = getCheckBoxValue(document.getElementsByName("donateShowName"));
    if ( needRecordName == "")
    {
      alert( "請幫我選擇是否要登記芳名錄 , 謝謝 !" );
      return;
    }

    document.getElementById("sectionForRecordName").style.display = "none";    
    document.getElementById("sectionForLonding").style.display = "block";  
    sendDataToExcel();
  }
  
  function ScuessSubmit(){
    document.getElementById("sectionForLonding").style.display = "none";    
    document.getElementById("tanksExplan").style.display = "block"; 
  }

  function NextToPurpose(){
    document.getElementById("tanksExplan").style.display = "none";    
    document.getElementById("purposeExplan").style.display = "block";    
  }

  function NextToPurpose(){
    document.getElementById("tanksExplan").style.display = "none";    
    document.getElementById("purposeExplan").style.display = "block";    
  }

  function NextToDeceive(){
    document.getElementById("purposeExplan").style.display = "none";    
    document.getElementById("deceiveExplan").style.display = "block";    
  }

  function NextToQuestion(){
    document.getElementById("deceiveExplan").style.display = "none";    
    document.getElementById("qustionExplan").style.display = "block";    
  }

  function NextToSup(){
    document.getElementById("qustionExplan").style.display = "none";    
    document.getElementById("supExplan").style.display = "block";    
  }


  function donateAddOneForBox01()
  {
    /* Check Box One content size */
    if( BoxOneContentSize >= 17)
      return;
    if( UseMoneyBag() == false )
      return ;
    BoxOneContentSize = BoxOneContentSize + 1;  
    UpdateMoneyBag();
    document.getElementById("boxOne").innerHTML = "已放入金幣袋數量 : " + BoxOneContentSize.toString();
    
  }

  function donateMinOneForBox01()
  {
    if( BoxOneContentSize == 1 )
    { return; }
    if( InsertMoneyBag() == false )
      return ;
    BoxOneContentSize = BoxOneContentSize - 1;
    UpdateMoneyBag();
    document.getElementById("boxOne").innerHTML = "已放入金幣袋數量 : " + BoxOneContentSize.toString();
  }

  function donateAddOneForBox02()
  {
    /* Check Box One content size */
    if( BoxTwoContentSize >= 17)
      return;
    if( UseMoneyBag() == false )
      return ;
      BoxTwoContentSize = BoxTwoContentSize + 1;  
    UpdateMoneyBag();
    document.getElementById("boxTwo").innerHTML = "已放入金幣袋數量 : " + BoxTwoContentSize.toString();
  }

  function donateMinOneForBox02()
  {
    if( BoxTwoContentSize == 1 )
    { return; }
    if( InsertMoneyBag() == false )
      return ;
      BoxTwoContentSize = BoxTwoContentSize - 1;
    UpdateMoneyBag();
    document.getElementById("boxTwo").innerHTML = "已放入金幣袋數量 : " + BoxTwoContentSize.toString();
  }

  function donateAddOneForBox03()
  {
    /* Check Box One content size */
    if( BoxThreeContentSize >= 17)
      return;
    if( UseMoneyBag() == false )
      return ;
      BoxThreeContentSize = BoxThreeContentSize + 1;  
    UpdateMoneyBag();
    document.getElementById("boxThree").innerHTML = "已放入金幣袋數量 : " + BoxThreeContentSize.toString();
  }

  function donateMinOneForBox03()
  {
    if( BoxThreeContentSize == 1 )
    { return; }
    if( InsertMoneyBag() == false )
      return ;
      BoxThreeContentSize = BoxThreeContentSize - 1;
    UpdateMoneyBag();
    document.getElementById("boxThree").innerHTML = "已放入金幣袋數量 : " + BoxThreeContentSize.toString();
  }

   /* Func - for show moneyBag */
  function UseMoneyBag()
  {
    /* 沒錢了 */
    if ( totalMoneyBag == 0 )
    {
      return false;
    }
    totalMoneyBag = totalMoneyBag - 1 ;
    totalMoneyBagUsed = totalMoneyBagUsed + 1;
    return true;
  }

   function InsertMoneyBag()
   {
      /* 沒錢了 */
      if ( totalMoneyBagUsed == 0 )
      {
        return false;
      }
      totalMoneyBag = totalMoneyBag + 1 ;
      totalMoneyBagUsed = totalMoneyBagUsed - 1;
      return true;
   }

  function UpdateMoneyBag()
  {
    document.getElementById("titleBarForMoneyBagCounter").innerHTML = totalMoneyBag.toString();
    document.getElementById("desForMoneyBagCounter").innerHTML = " X " +  totalMoneyBag.toString();
  }

  function getStoryInfo(storyType)
  {
    myStoryType = storyType
    var subjectInfo = {
      'storyType' : myStoryType
    }
    $.ajax({
        type: "get",
        url: "https://script.google.com/macros/s/AKfycbxJs1MCV4T6Ffc0g9hnH-fj8AyqmAwRYIGdextzsTfip2syH4c/exec",
        data: subjectInfo,
        dataType: "JSON",
        success: function (data) {
          document.getElementById("moneyDes").innerHTML = data['MoneyDes'] ;
          document.getElementById("finalDes01").innerHTML = data['FinalDes01'] ;
          document.getElementById("finalDes02").innerHTML = data['FinalDes02'] ;
          document.getElementById("finalDes03").innerHTML = data['FinalDes03'] ;
          setInterval(loadingDivOpaFade, 100);
        }
      });
  }

  function sendDataToExcel()
  {

    thisPageUsingTimerStop();
    var totalSec = Number(getCookie("one_pageTime")) + Number(getCookie("two_pageTime")) + Number(getCookie("three_pageTime")) + thisPageUsingTime;
    // Get subject info 
    var needRecordName = getCheckBoxValue(document.getElementsByName("donateShowName"));
    var subjectInfo = {
      'Name' : getCookie("subjectName") ,
      'Gender' : getCookie("subjectGender") ,
      'Age' : getCookie("subjectAge") ,
      'Phone' : getCookie("subjectPhone") ,
      'Email' : getCookie("subjectEmail") ,
      'StoryHintType' : userSituation ,
      'StoryOne_Type' : storyOne,
      'StoryOne_Art' : getCookie("one_subjectInputArt") ,
      'StoryOne_UseTimes' : getCookie("one_subjectInputArtTime") ,
      'StoryOne_MR' : getCookie("one_mrv"),
      'StoryOne_AR' : getCookie("one_arv"),
      'StoryTwo_Type' : storyTwo,
      'StoryTwo_Art' : getCookie("two_subjectInputArt") ,
      'StoryTwo_UseTimes' : getCookie("two_subjectInputArtTime") ,
      'StoryTwo_MR' : getCookie("two_mrv"),
      'StoryTwo_AR' : getCookie("two_arv"),
      'StoryThree_Type' : storyThree,
      'StoryThree_Art' : getCookie("three_subjectInputArt") ,
      'StoryThree_UseTimes' : getCookie("three_subjectInputArtTime") ,
      'StoryThree_MR' : getCookie("three_mrv"),
      'StoryThree_AR' : getCookie("three_arv"),
      'DonateGoh' : BoxOneContentSize,
      'DonateDep' : BoxTwoContentSize,
      'DonateAft' : BoxThreeContentSize,
      'NeedRecordName' : needRecordName,
      'TotalSec' : totalSec
    }
    $.ajax({
        type: "post",
        url: "https://script.google.com/macros/s/AKfycbxWOB548AGfz9OqUFSKRaBkkWXDpMpyxOr3ronUNJ5VyABRFm4/exec",
        data: subjectInfo ,
        dataType: "JSON",
        success: function (response) {
          ScuessSubmit();
        }
      });
   }

  var thisPageUsingTimeID = -1;
  var thisPageUsingTime = 0;
  
  function thisPageUsingTimerEvent()
  {
    thisPageUsingTime++ ; 
  }

  function thisPageUsingTimerStart()
  {
    thisPageUsingTimeID = setInterval(thisPageUsingTimerEvent , 1000);
  }

  function thisPageUsingTimerStop()
  {
    clearTimeout(thisPageUsingTimeID);
  }

  </script>

</html>



